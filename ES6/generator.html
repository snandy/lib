<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Generator Function</title>
    <script src="http://misc.360buyimg.com/jdf/lib/jquery-1.6.4.js"></script>
	<script src="generator.js"></script>
</head>
<body>
	<p>
		两次Ajax返回的结果相加为：<span id="a1">ajax1()</span> + <span id="a2">ajax2()</span> = <span id="a3">?</span>
	</p>
	<p>
		<textarea style="width:500px;height:400px">
function ajax1(callback) {
	$.getJSON('a.txt', function(obj) {
		callback(obj)
		a1.innerHTML = obj.v
	})
}
function ajax2(callback) {
	$.getJSON('b.txt', function(obj) {
		callback(obj);
		a2.innerHTML = obj.v
	})
}
function *delayAjax(resume) {
	var r1 = yield ajax1(resume)
	var r2 = yield ajax2(resume)
	return r1.v + r2.v
}

function run() {
	var iter = delayAjax(resume)
	function resume(callbackValue) {
		var rs = iter.next(callbackValue)
		if (rs.done) {
			console.log(rs.value)
			a3.innerHTML = rs.value
		}
	}
	iter.next()
}

run()	
		</textarea>
	</p>
</body>
</html>